services:
  airdata:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.airdata
    container_name: airdata

  battery:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.battery
    container_name: battery

  engine:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.engine
    container_name: engine

  gps:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.gps
    container_name: gps

  imu:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.imu
    container_name: imu

  aggregation:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.aggregation
    container_name: aggregation
    depends_on:
      - airdata
      - battery
      - engine
      - gps
      - imu
    ports:
      - "50051:50051"

  analysis:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.analysis
    container_name: analysis
    depends_on:
      - aggregation
    ports:
      - "50052:50052"

  update:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.update
    container_name: update
    depends_on:
      - analysis
    ports:
      - "50054:50054"

  server:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.server
    container_name: server
    depends_on:
      - update
    ports:
      - "50053:50053"

  client:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.client
    container_name: client
    depends_on:
      - server
    stdin_open: true
    tty: true